# 실행 컨텍스트

## 실행 컨텍스트 \| Context



 실행 컨텍스트는 **Scope**, **Hoisting**, **this**, **function**, **closure**등의 동작 원리를 담고 있는 자바스크립트의 핵심 원리입니다.

 이를 올바르게 이해하지 못하면 코드 독해가 어려워지고, 디버깅도 힘들어집니다.

 실행 컨텍스트를 쉽게 정의하면 실행 가능한 코드가 실행되기 위해 필요한 환경이다. 이때 실행 가능한 코드란 다음과 같다.

* **전역 코드** \| 전역 영역에 존재하는 코드
* **Eval 코드** \| Eval 함수로 실행되는 코드
* **함수 코드** \| 함수 내에 존재하는 코드 

 자바스크립트 엔진은 코드를 실행하기 위하여 실행에 필요한 여러가지 정보를 알고있어야합니다. 실행에 필요한 여러가지 정보란 다음과 같습니다.

* **변수\(Variable\)** \| 전역 변수, 지역 변수, 매개 변수, 객체의 프로퍼티
* **함수 선언**
* **변수의 유효범위\(Scope\)** \[\[scope\]\]
* **this** \| 일반 객체 또는 전역 객체 

 이와 같이 실행에 필요한 정보를 형상화하고 구분하기 위해 자바스크립트 엔진은 실행 컨텍스트를 물리적 객체의 형태로 저장합니다. 

### 실행 컨텍스트 

실행 컨텍스트는 자바스크립트 코드를 실행하는 환경입니다. 자바스크립트 코드가 실행되면 모든 것을 포함하는 전역 컨텍스트가 생기고 이는 페이지가 종료될 때까지 유지됩니다. 

 그 후 자바스크립트는 함수가 호출될 때마다 함수 컨텍스트를 하나 씩 생성합니다. 컨텍스트는 다음의 5가지 원칙을 따릅니다.

* 하나의 전역 컨텍스트 생성 후 함수 호출 시마다 컨텍스트가 생깁니다.
* 컨텍스트 생성 시 컨텍스트 안에 **변수객체\(arguments, variable\)**, **scope chain**, **this**가 생성됩니다.
* 컨텍스트 생성 후 함수가 실행되는데, 사용되는 변수들은 변수 객체 안에서 값을 찾고, 없다면 스코프체인을 따라 올라가며 찾습니다.
* 함수 실행이 마무리 되면 해당 컨텍스트는 사라집니다. 단 클로저는 제외합니다.
* 페이지가 종료되면 전역 컨텍스트가 사라집니다. 

### 실행 컨텍스트 순서

1. 전역 컨텍스트 객체 생성

   * 전역 실행 컨텍스트에서 만들어지는 객체는 전역 객체라고 한다. 전역적으로 선언된 변수와 함수가 전역객체의 속성이 된다.

2. 자바스크립트 실행 후 선언되어 있는 함수들의 객체가 만들어진다. 

   * 함수 내의 내부 함수는 제외시킨다. 내부 함수는 부모 함수의 컨텍스트가 생성될 때 만들어진다.

3. 전역 실행 컨텍스트의 스코프 정보 생성. 전역 실행 컨텍스트의 스코프 체인에는 처음에 전역 객체가 추가된다.

4. 만들어진 함수 객체들의 \[\[scope\]\]는 이 스코프 체인을 참조한다.\(전역 컨텍스트 객체의 스코프체인\)

5. 변수 생성

   * 파라미터, 변수, 함수들이 메모리에 생성되고 각 프로퍼티에 설정되며 초기화는 되지 않는다.

6. this 바인딩

   * 변수 객체 내에는 this라는 프로퍼트가 있고 이것은 전역객체 또는 일반객체를 가리킨다.

7. 표현식이 실행이 실행되면서 초기화, 연산, 다른 함수, 표현식 함수가 실행된다.

   * 다른 함수가 실행\(함수 호출\)시에 새로운 실행 컨텍스트가 실행된다. 실행에 필요한 여러가지 정보를 담기 위해 객체를 생성하는데 이를 활성 객체\(변수객체\) 라고 한다. 이곳에는 매개변수, 변수, 객체가 저장된다.

8. arguments 객체 생성

   * arguments 객체가 생서어되고 활성 객체 안에 arguments 속성은 arguments 객체를 참조한다. 전역 객체에서는 생성되지 않는다.

9. 새로운 실행 컨텍스트의 \[\[scope\]\]는 해당 함수 객체의 \[\[scope\]\]를 복사한다.

10. 스코프 체인에 자신의 변수객체를 추가한다.그리고 함수 내에 내부 함수들의 객체의 \[\[scope\]\]는 이 스코프 체인을 참조한다.

11. 변수 생성

12. this 바인딩

13. 실행 

14. 더 이상 실행되는 코드가 없으면 실행 컨텍스트는 사라진다.

### 

